//** OIR - OPAC.isisRBE
function fechar(){document.getElementById("fechar").style.display="none",document.getElementById("frmlogin").style.display="none"}function getInnerText(e){var t=e.innerText;return void 0==t&&(t=e.innerHTML.replace(/<[^>]+>/g,"")),t}function setInnerText(e,t){document.all?document.getElementById(e).innerText=t:document.getElementById(e).textContent=t}function submitNS(){var e=getInnerText(document.getElementById("entrada"));"Entrar"==(e=e.trim())?(document.getElementById("frmlogin").style.display="",document.getElementById("Password").value="",document.getElementById("fechar").style.display=""):document.getElementById("frmlogin").action="/rbcatalogo/login.asp?Logout.asp"}function validar(){var e=getInnerText(document.getElementById("entrada"));"Entrar"==(e=e.trim())?(document.getElementById("frmlogin").style.display="",document.getElementById("Password").value="",document.getElementById("fechar").style.display=""):"Microsoft Internet Explorer"==navigator.appName?(getPage("logout.asp","POST","true",null,null),document.getElementById("menu").innerHTML=""):window.location.href="/rbcatalogo/logout.asp?referr=NS"}function getfields(){var e="Login=1";return e=e+"&"+["Nickname="+document.getElementById("Nickname").value,"Password="+document.getElementById("Password").value].join("&")}function createRequestObject(){return window.XMLHttpRequest?xmlhttprequest=new XMLHttpRequest:window.ActiveXObject?xmlhttprequest=new ActiveXObject("Microsoft.XMLHTTP"):void 0}function getPage(e,t,n,o,r){return goAjax(e+"?"+r+"&rnd"+Math.random(),t,n,o),!1}function goAjax(e,t,n,o,r){xmlhttp=createRequestObject(),"GET"==t?xmlhttp.open("GET",e,n):(xmlhttp.open("POST",e,n),xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=iso-8859-1"),xmlhttp.setRequestHeader("Cache-Control","no-store, no-cache, must-revalidate"),xmlhttp.setRequestHeader("Cache-Control","post-check=0, pre-check=0"),xmlhttp.setRequestHeader("Pragma","no-cache")),xmlhttp.onreadystatechange=function(){if(4==xmlhttp.readyState)switch(retorno=xmlhttp.responseText,retorno){case"":document.getElementById("entrada").innerText="Entrar",document.getElementById("utilizador").innerText="Visitante",document.getElementById("lblutilizador").style.display="",document.getElementById("menu").innerHTML="",document.getElementById("frmlogin").style.display="none";break;default:if(-1==retorno.indexOf("xpto")){document.getElementById("entrada").innerText="Sair";var e=retorno.indexOf("=")+2;document.getElementById("utilizador").innerText=retorno.substring(e,retorno.indexOf(";",e)-1),document.getElementById("lblutilizador").style.display="",document.getElementById("menu").innerHTML='<ul><li style="list-style-type: none;margin-left:-40px;"> <a href="admin/admin.asp">Administração</a></li></ul>',document.getElementById("frmlogin").style.display="none"}}},"GET"==t?xmlhttp.send(null):xmlhttp.send(r)}String.prototype.trim=function(){return this.replace(/^\s*|\s*$/,"")};